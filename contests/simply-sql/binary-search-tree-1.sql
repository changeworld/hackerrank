SELECT N, (CASE
  WHEN ISNULL(P) THEN 'Root'
  WHEN (SELECT COUNT(*) FROM BST AS BST2 WHERE BST2.P = BST.N) = 0 THEN 'Leaf'
  ELSE 'Inner'
  END)
FROM BST
ORDER BY N;